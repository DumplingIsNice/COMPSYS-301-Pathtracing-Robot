Version 4
SHEET 1 3012 680
WIRE 720 -176 528 -176
WIRE 992 -176 800 -176
WIRE 432 -48 304 -48
WIRE 528 -48 528 -176
WIRE 528 -48 496 -48
WIRE 560 -48 528 -48
WIRE 656 -48 624 -48
WIRE 736 -48 656 -48
WIRE 800 -48 768 -48
WIRE 992 -32 992 -176
WIRE 992 -32 864 -32
WIRE 1200 -32 992 -32
WIRE 1312 -32 1280 -32
WIRE 1408 -32 1312 -32
WIRE 1728 -32 1632 -32
WIRE 1808 -32 1728 -32
WIRE 1904 -32 1808 -32
WIRE 2016 -32 1904 -32
WIRE 736 -16 736 -48
WIRE 800 -16 736 -16
WIRE 1312 32 1312 -32
WIRE -304 48 -304 -48
WIRE -64 48 -64 -80
WIRE 768 48 768 -48
WIRE 880 48 768 48
WIRE 992 48 992 -32
WIRE 992 48 960 48
WIRE 1728 48 1728 -32
WIRE 1808 48 1808 -32
WIRE 1904 48 1904 -32
WIRE 656 80 656 -48
WIRE 768 80 768 48
WIRE -64 208 -64 128
WIRE 768 208 768 160
WIRE 768 208 304 208
WIRE 1312 208 1312 96
WIRE 1312 208 768 208
WIRE 1728 208 1728 112
WIRE 1728 208 1664 208
WIRE 1808 208 1808 112
WIRE 1808 208 1728 208
WIRE 1904 208 1904 128
WIRE 1904 208 1808 208
WIRE 560 336 528 336
WIRE 656 336 656 160
WIRE 656 336 640 336
WIRE 688 336 656 336
WIRE 816 336 768 336
WIRE -64 480 -64 288
FLAG -64 480 0
FLAG -64 -80 Vsensor
IOPIN -64 -80 BiDir
FLAG 304 -48 Vsensor
IOPIN 304 -48 BiDir
FLAG -304 128 0
FLAG -304 -48 Vcc
IOPIN -304 -48 BiDir
FLAG 832 -64 Vcc
IOPIN 832 -64 BiDir
FLAG 832 0 0
FLAG 304 208 0
FLAG 1408 -32 Vout
IOPIN 1408 -32 Out
FLAG 816 336 0
FLAG 528 336 Vcc
IOPIN 528 336 BiDir
FLAG 1664 208 0
FLAG 1632 -144 Vout
IOPIN 1632 -144 Out
FLAG 2016 -32 Vpeak
IOPIN 2016 -32 Out
SYMBOL voltage -64 32 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 200m
SYMATTR InstName Vprojector
SYMATTR Value SINE(300m 200m 120)
SYMBOL voltage -64 192 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 100m
SYMATTR InstName Vlablights
SYMATTR Value SINE(0 100m 100)
SYMBOL cap 496 -64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {C1}
SYMBOL cap 624 -64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value {C1}
SYMBOL res 816 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {R1}
SYMBOL res 672 176 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R2
SYMATTR Value {R1}
SYMBOL OpAmps\\UniversalOpamp2 832 -32 R0
SYMATTR InstName U1
SYMBOL voltage -304 32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vpsoc
SYMATTR Value 5
SYMBOL res 752 64 R0
SYMATTR InstName R4
SYMATTR Value {Rq1}
SYMBOL res 976 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {Rq2}
SYMBOL cap 1328 96 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C3
SYMATTR Value {Chp}
SYMBOL res 1296 -48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value {Rhp}
SYMBOL res 656 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {Rvdu}
SYMBOL res 784 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value {Rvdl}
SYMBOL diode 1792 -128 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N914
SYMBOL res 1888 32 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL cap 1792 48 R0
SYMATTR InstName C4
SYMATTR Value 330n
TEXT 456 464 Left 2 !.param R1=100k C1=12n
TEXT 968 344 Left 2 !.param Rq1=10k Rq2=10k
TEXT -376 400 Left 2 !.tran 1s
TEXT -424 352 Left 2 !;ac dec 10 1 100k
TEXT 968 304 Left 2 !.param Rhp=820 Chp=100n
TEXT 456 432 Left 2 !.param Rvdu=330k Rvdl=39k
TEXT 464 544 Left 2 ;This acts as a DC offset.\nRemember that it has a gain set by the Q [(Rq1+Rq2)/Rq1].\n \nWith a Q of 2 (10k,10k) to get 1 V offset at output we require a voltage of 0.5V
TEXT 976 464 Left 2 ;.param R1=100k C1=13.3n
TEXT 976 496 Left 2 ;.param Rvdu=90k Rvdl=10k
TEXT 976 424 Left 2 ;.param Rhp=1k Chp=79.58n
TEXT 2040 152 Left 2 ;T = RC where 5T is the time to fully charge/discharge.\nAt f=120Hz T=8.3ms, thus if we want the peak to be the average of 2 periods then:\n5T = 2*(1/120) -> T = 10/3*E-3\n \nIf R=10k then C=333nF->330nF E12
